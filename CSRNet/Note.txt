1.将.ipynb文件中的代码黏贴转变为.py文件


2.修改json中的数据集代码位置，包括make_dataset.py中的root


3.make_dataset.py
	(1)路径问题
	
	(2)报错
		Traceback (most recent call last):
		  File "E:\PostGrauate\PaperRecurrent\目标计数\CSRNet-pytorch-master\make_dataset.py", line 84, in <module>
			k = gaussian_filter_density(k)
		  File "E:\PostGrauate\PaperRecurrent\目标计数\CSRNet-pytorch-master\make_dataset.py", line 30, in gaussian_filter_density
			tree = scipy.spatial.KDTree(pts.copy(), leafsize=leafsize)
		  File "D:\Softwares\Anaconda\envs\Pytorch\lib\site-packages\scipy\spatial\_kdtree.py", line 360, in __init__
			super().__init__(data, leafsize, compact_nodes, copy_data,
		  File "_ckdtree.pyx", line 557, in scipy.spatial._ckdtree.cKDTree.__init__
		TypeError: float() argument must be a string or a real number, not 'zip'
	解决办法：改成 pts = np.array(list(zip(np.nonzero(gt)[1], np.nonzero(gt)[0])))


4.训练过程：
	(1)FileNotFoundError: [Errno 2] No such file or directory: 'train.json'
		python train.py train.json val.json 0 0  使用的GPU序号  线程数
	解决方法：python train.py part_A_train.json part_A_val.json 0 0
	
	(2)	Traceback (most recent call last):
		  File "E:\PostGrauate\PaperRecurrent\目标计数\CSRNet-pytorch-master\train.py", line 230, in <module>
			main()        
		  File "E:\PostGrauate\PaperRecurrent\目标计数\CSRNet-pytorch-master\train.py", line 65, in main
			model = CSRNet()
		  File "E:\PostGrauate\PaperRecurrent\目标计数\CSRNet-pytorch-master\model.py", line 18, in __init__
			for i in xrange(len(self.frontend.state_dict().items())):
		NameError: name 'xrange' is not defined. Did you mean: 'range'?
	解决方法：按照提示找到代码改为range
	
	(3)	Traceback (most recent call last):
	  File "E:\PostGrauate\PaperRecurrent\目标计数\CSRNet-pytorch-master\train.py", line 230, in <module>
		main()
	  File "E:\PostGrauate\PaperRecurrent\目标计数\CSRNet-pytorch-master\train.py", line 65, in main
		model = CSRNet()
	  File "E:\PostGrauate\PaperRecurrent\目标计数\CSRNet-pytorch-master\model.py", line 19, in __init__
		self.frontend.state_dict().items()[i][1].data[:] = mod.state_dict().items()[i][1].data[:]
	TypeError: 'odict_items' object is not subscriptable
	解决方法：在Python中，如果你遇到了错误信息 "'odict_items' object is notsubscriptable"，这通常意味着你尝试对一个不可下标访问的对象进行了下标操作。在Python的collections.OrderedDict中，items()方法返回的是一个odict_items对象，这是一个迭代器，而不是一个列表，因此你不能使用下标来访问它的元素。要解决这个问题，你可以将odict_items对象转换为一个列表，然后进行下标访问。
	list(self.frontend.state_dict().items())[i][1].data[:] = list(mod.state_dict().items())[i][1].data[:]
	
	(4)    data = [self.dataset[idx] for idx in possibly_batched_index]
	  File "E:\PostGrauate\PaperRecurrent\目标计数\CSRNet-pytorch-master\dataset.py", line 33, in __getitem__
		img,target = load_data(img_path,self.train)
	  File "E:\PostGrauate\PaperRecurrent\目标计数\CSRNet-pytorch-master\image.py", line 40, in load_data
		target = cv2.resize(target,(target.shape[1]/8,target.shape[0]/8),interpolation = cv2.INTER_CUBIC)*64
	cv2.error: OpenCV(4.10.0) :-1: error: (-5:Bad argument) in function 'resize'
	> Overload resolution failed:
	>  - Can't parse 'dsize'. Sequence item with index 0 has a wrong type
	>  - Can't parse 'dsize'. Sequence item with index 0 has a wrong type
	解决方法：target = cv2.resize(target, (target.shape[1] // 8, target.shape[0] // 8), interpolation=cv2.INTER_CUBIC) * 64


5. 测试过程： 
	




参考文献：
https://gitee.com/lonelyislandXD/learnCSRNet/blob/master/make_dataset.ipynb
https://blog.csdn.net/wpw5499/article/details/111496715
https://www.bilibili.com/video/BV16p421y7gZ/?spm_id_from=333.999.0.0&vd_source=2bc111f87179a725084a4767406ef2a9
https://blog.csdn.net/qq_45073592/article/details/133895731

torch: 2.3.21
CUDA: 12.5
